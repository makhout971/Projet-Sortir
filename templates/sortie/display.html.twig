{% extends 'layout.html.twig' %}

    {% block body %}
        {% for flashMessage in app.session.flashbag.get('successInscription') %}
        <div style="color: darkgreen" style="font-weight: bold">
       <h2>{{ flashMessage }}</h2>
        </div>
        {%  endfor %}
        {% for flashMessage in app.session.flashbag.get('successDesInscription') %}
            <div style="color: darkgreen" style="font-weight: bold">
                <h2>{{ flashMessage }}</h2>
            </div>
        {%  endfor %}

        {%  if message  %}
            <h1>{{ message }}</h1>
        {% endif %}
        <div id="lesSorties">
        <ul>

            {% for sortie in entities %}
                {% if sortie.etat.id != 6  %}
                {% set userInscritSortie = false %}
                    {% if sortie.Users.contains(app.user) %}
                    {% set userInscritSortie = true %}
                    {% endif %}
{#                {% for flashMessage in app.session.flashbag.get('echecInscriptionSortie') %}#}
{#                    <div style="color: darkgreen" style="font-weight: bold">#}
{#                        <h2>{{ flashMessage }}</h2>#}
{#                    </div>#}
{#                {%  endfor %}#}
{#                {% for flashMessage in app.session.flashbag.get('echecDesInscriptionSortie') %}#}
{#                    <div style="color: darkgreen" style="font-weight: bold">#}
{#                        <h2>{{ flashMessage }}</h2>#}
{#                    </div>#}
{#                {%  endfor %}#}
{#                {% for flashMessage in app.session.flashbag.get('palierInscritsMax') %}#}
{#                    <div style="color: darkgreen" style="font-weight: bold">#}
{#                        <h2>{{ flashMessage }}</h2>#}
{#                    </div>#}
{#                {%  endfor %}#}





                <li><h5>Nom de la sortie : </h5>{{ sortie.nom }}</li>
                <li><h5>Date et heure de début : </h5>{{ sortie.dateHeureDebut.date }}</li>
                <li><h5>Date limite d'inscription : </h5>{{ sortie.dateLimiteInscription.date}}</li>
{#                <li>{{ (sortie.dateHeureDebut)-(sortie.dateHeureFin) }}</li>#}
{#                TODO: chercher nb d'inscrits en base#}
                <li><h5>Nombre de participants maximum</h5>{{ sortie.nbInscriptionMax }}</li>
                <li><h5>Etat de la sortie : </h5>{{ sortie.etat.libelle }}</li>
{#                TODO: chercher si utilisateur en session inscrit#}
                <li><h5>Pseudo de l'organisateur</h5>{{ sortie.userOrganisateur.username }} </li>


                <li> <a href="{{ path('afficherUneSortie',{'id' :  sortie.id}) }}"> Afficher</a> </li>
               {% if  sortie.etat.id == 2 and userInscritSortie==false and sortie.users.count < sortie.nbInscriptionMax %}
                <li > <a href="{{ path('inscriptionSortie',{'id' :  sortie.id}) }}"> S'inscrire</a> </li>
{#                   onclick="confirm('Confirmez votre inscription')"#}
             {% endif %}
                {% if  sortie.etat.id == 2 and userInscritSortie==true %}
                    <li > <a href="{{ path('desinscriptionSortie',{'id' :  sortie.id}) }}"> Se désinscrire</a> </li>
{#                    onclick="confirm('Confirmez votre désinscription')"#}

                {% endif %}
                <br>
               {% endif %}
            {% endfor %}
        </ul>


        <button id="btnLesSorties"><a  href="{{ path('sortie') }}">Créer une sortie</a></button>
        </div>
    {% endblock %}



